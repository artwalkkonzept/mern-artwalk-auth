(this["webpackJsonpreact-artwalk-auth-api"]=this["webpackJsonpreact-artwalk-auth-api"]||[]).push([[0],{67:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(30),s=n.n(c),i=n(9),o=n.n(i),l=n(12),u=n(8),j=n(13),b=n(31),h=n(32),d=function(){function e(t){Object(b.a)(this,e),this.auth_api_url=t}return Object(h.a)(e,[{key:"login",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.auth_api_url,{method:"POST",body:JSON.stringify({username:t,password:n})});case 2:return r=e.sent,e.next=5,r.json();case 5:if(a=e.sent,![401,404].includes(parseInt(r.status))){e.next=8;break}throw Error(a.msg);case 8:return this.setToken(a.token),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loggedIn",value:function(){return null!==this.getToken()}},{key:"setToken",value:function(e){localStorage.setItem("token",e)}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"logout",value:function(){localStorage.removeItem("token")}},{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n={Accept:"application/json","Content-Type":"application/json"};return this.loggedIn()&&(n.Authorization="Bearer ".concat(this.getToken())),fetch(e,Object(j.a)({headers:n},t))}))}]),e}(),p=d,O=n(1);var f=function(e){var t=Object(r.useState)(""),n=Object(u.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),i=Object(u.a)(s,2),o=i[0],l=i[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("h3",{children:"Login"}),Object(O.jsx)("input",{onChange:function(e){return c(e.target.value)},name:"username",type:"text",placeholder:"username"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{onChange:function(e){return l(e.target.value)},name:"password",type:"password",placeholder:"password"}),Object(O.jsx)("br",{}),Object(O.jsx)("button",{onClick:function(){e.login(a,o)},children:"Login"})]})},x=n(14),g=n(2),m=n(17),v=n(20),k=n.n(v);var w=function(){var e=Object(r.useState)([{name:"",bilds:""}]),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)({name:"",bilds:""}),s=Object(u.a)(c,2),i=s[0],o=s[1];function l(e){var t=e.target,n=t.name,r=t.value;o((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(m.a)({},n,r))}))}return Object(r.useEffect)((function(){fetch("/artwalks").then((function(e){if(e.ok)return e.json()})).then((function(e){return a(e)}))})),Object(O.jsxs)("div",{className:"App",style:{marginTop:20},children:[Object(O.jsx)("h3",{children:"Create Artwalk"}),Object(O.jsxs)("form",{className:"formPost",children:[Object(O.jsx)("label",{children:"ArtWalk: "}),Object(O.jsx)("li",{children:Object(O.jsx)("input",{id:"Name",onChange:l,name:"name",value:i.name})}),Object(O.jsx)("label",{children:"Bilder: "}),Object(O.jsx)("li",{children:Object(O.jsx)("input",{id:"Bilds",onChange:l,name:"bilds",value:i.bilds})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:function(e){e.preventDefault();var t={name:i.name,bilds:i.bilds};k.a.post("/newartwalk",t)},children:"Add artwalk"})})]}),Object(O.jsx)("hr",{}),Object(O.jsx)("h3",{children:"Liste der Artwalks"}),n.map((function(e){return Object(O.jsxs)("div",{className:"formPost",children:[Object(O.jsx)("h4",{className:"h1Title",children:e.name}),Object(O.jsx)("p",{className:"pDescription",children:e.bilds}),Object(O.jsx)("button",{onClick:function(){return t=e._id,void k.a.delete("/delete/"+t);var t},children:"Delete"})]})}))]})},y=function(){return Object(O.jsxs)("nav",{children:[Object(O.jsx)(x.b,{style:{margin:8},to:"/",children:"Home"}),Object(O.jsx)(x.b,{to:"/form",className:"navbar-brand",children:"Create ArtWalk"}),Object(O.jsx)("div",{className:"container mt-3",children:Object(O.jsx)(g.c,{children:Object(O.jsx)(g.a,{path:"/form",component:w})})})]})},S="http://localhost:8080/api",C=new p("".concat(S,"/users/authenticate"));var N=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(0),s=Object(u.a)(c,2),i=s[0],j=s[1];function b(){return(b=Object(l.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.login(t,n);case 3:r=e.sent,console.log("Authentication:",r.msg),j(i+1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Login",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}Object(r.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(S,"/artwalks"),e.next=3,C.fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,a(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[i]);var h=Object(O.jsx)("p",{children:"No artwalks!"});return n.length>0&&(h=Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(y,{}),Object(O.jsx)("hr",{})]})),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("h1",{children:"Artwalks"}),h,Object(O.jsx)(f,{login:function(e,t){return b.apply(this,arguments)}}),C.loggedIn()?Object(O.jsx)("pre",{children:"User is logged in"}):Object(O.jsx)("pre",{children:"User is not logged in"})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(x.a,{children:Object(O.jsx)(N,{})})}),document.getElementById("root")),T()}},[[67,1,2]]]);
//# sourceMappingURL=main.5bfdc49d.chunk.js.map